import{_ as P}from"./PagiNation-b3101f32.js";import{g as D,y as j,r as s,o as u,c as p,a as t,F as C,h as U,e as g,f as B,b as V,t as k,j as I,u as R,R as T,m as z,z as S,l as N,w as r,v as _,A,B as E,s as G,d as O}from"./index-cc47edcd.js";import{i as b}from"./backend-87cf0435.js";import{M as q}from"./modal-252a361c.js";import{_ as H}from"./DelModal-de5312cf.js";import"./component-functions-4dab0694.js";const J={class:"navbar navbar-expand-lg navbar-light bg-light"},K={class:"container-fluid"},Q=t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1),W={class:"collapse navbar-collapse",id:"navbarNav"},X={class:"navbar-nav"},Y={class:"nav-item"},Z=["onClick"],tt={__name:"Nav-bar",setup(w){const h=D(),f=()=>{b.post("/logout").then(o=>{o.data.success&&h.push("/login")})},n=j({list_index:s(0),list:[{name:"產品",link:"/dash/products"},{name:"訂單",link:"/dash/orders"},{name:"優惠券",link:"/dash/coupons"},{name:"文章",link:"/dash/article"}],currency_index(o){n.list_index=o}});return(o,v)=>(u(),p("nav",J,[t("div",K,[Q,t("div",W,[t("ul",X,[(u(!0),p(C,null,U(n.list,(a,i)=>(u(),p("li",{class:"nav-item",key:a.name},[g(R(T),{onClick:y=>n.currency_index(i),class:I([{active:n.list_index===i},"nav-link"]),to:a.link},{default:B(()=>[V(k(a.name),1)]),_:2},1032,["onClick","class","to"])]))),128)),t("li",Y,[t("a",{class:"nav-link",href:"#",onClick:z(f,["prevent"])},"登出",8,Z)])])])])]))}},et={class:"modal-dialog modal-xl",role:"document"},at={class:"modal-content border-0"},lt=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ot={class:"modal-body"},st={class:"row"},nt={class:"col-sm-4"},it={class:"mb-3"},dt=t("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),ct={class:"mb-3"},rt=t("label",{for:"customFile",class:"form-label"},[V("或 上傳圖片 "),t("i",{class:"fas fa-spinner fa-spin"})],-1),ut=["src"],pt=E('<div class="mt-5"><div class="mb-3 input-group"><input type="url" class="form-control form-control" placeholder="請輸入連結"><button type="button" class="btn btn-outline-danger"> 移除 </button></div><div><button class="btn btn-outline-primary btn-sm d-block w-100"> 新增圖片 </button></div></div>',1),mt={class:"col-sm-8"},_t={class:"mb-3"},vt=t("label",{for:"title",class:"form-label"},"標題",-1),bt={class:"row gx-2"},ht={class:"mb-3 col-md-6"},ft=t("label",{for:"category",class:"form-label"},"分類",-1),gt={class:"mb-3 col-md-6"},yt=t("label",{for:"price",class:"form-label"},"單位",-1),kt={class:"row gx-2"},xt={class:"mb-3 col-md-6"},$t=t("label",{for:"origin_price",class:"form-label"},"原價",-1),wt={class:"mb-3 col-md-6"},Mt=t("label",{for:"price",class:"form-label"},"售價",-1),Ct=t("hr",null,null,-1),Ut={class:"mb-3"},Vt=t("label",{for:"description",class:"form-label"},"產品描述",-1),Nt={class:"mb-3"},Ft=t("label",{for:"content",class:"form-label"},"說明內容",-1),Lt={class:"mb-3"},Pt={class:"form-check"},Dt=t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),jt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1),Bt={__name:"Product-modal",props:{product:{type:Object,default:()=>({})}},emits:["update-product"],setup(w,{expose:h,emit:f}){const n=w,o=s({}),v=s(null),a=s({}),i=s(null);function y(){f("update-product",a.value)}S(()=>n.product,()=>{a.value=n.product},{deep:!0});const m=()=>{o.value.show()},x=()=>{o.value.hide()};N(()=>{o.value=new q(v.value)}),h({myModal_show:m,myModal_hide:x});function M(){const $=i.value.files[0],l=new FormData;l.append("file-to-upload",$),b.post("/api/karabo-api-cake/admin/upload",l).then(e=>{console.log(e.data),e.data.success&&(a.value.imageUrl=e.data.imageUrl,i.value.value="")})}return($,l)=>(u(),p("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref_key:"modal",ref:v},[t("div",et,[t("div",at,[lt,t("div",ot,[t("div",st,[t("div",nt,[t("div",it,[dt,r(t("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=e=>a.value.imageUrl=e),class:"form-control",id:"image",placeholder:"請輸入圖片連結"},null,512),[[_,a.value.imageUrl]])]),t("div",ct,[rt,t("input",{type:"file",id:"customFile",class:"form-control",onChange:M,ref_key:"fileInput",ref:i},null,544)]),t("img",{class:"img-fluid",alt:"",src:a.value.imageUrl},null,8,ut),pt]),t("div",mt,[t("div",_t,[vt,r(t("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":l[1]||(l[1]=e=>a.value.title=e)},null,512),[[_,a.value.title]])]),t("div",bt,[t("div",ht,[ft,r(t("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入分類","onUpdate:modelValue":l[2]||(l[2]=e=>a.value.category=e)},null,512),[[_,a.value.category]])]),t("div",gt,[yt,r(t("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":l[3]||(l[3]=e=>a.value.unit=e)},null,512),[[_,a.value.unit]])])]),t("div",kt,[t("div",xt,[$t,r(t("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":l[4]||(l[4]=e=>a.value.origin_price=e)},null,512),[[_,a.value.origin_price]])]),t("div",wt,[Mt,r(t("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":l[5]||(l[5]=e=>a.value.price=e)},null,512),[[_,a.value.price]])])]),Ct,t("div",Ut,[Vt,r(t("textarea",{"onUpdate:modelValue":l[6]||(l[6]=e=>a.value.description=e),type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述"},null,512),[[_,a.value.description]])]),t("div",Nt,[Ft,r(t("textarea",{"onUpdate:modelValue":l[7]||(l[7]=e=>a.value.content=e),type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容"},null,512),[[_,a.value.content]])]),t("div",Lt,[t("div",Pt,[r(t("input",{class:"form-check-input","onUpdate:modelValue":l[8]||(l[8]=e=>a.value.is_enabled=e),type:"checkbox","true-value":1,"false-value":0,id:"is_enabled"},null,512),[[A,a.value.is_enabled]]),Dt])])])])]),t("div",{class:"modal-footer"},[jt,t("button",{type:"button",class:"btn btn-primary",onClick:y},"確認")])])])],512))}},It={class:"text-end mt-3"},Rt={class:"table mt-4"},Tt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"200"},"編輯")])],-1),zt={class:"text-right"},St={class:"text-right"},At={key:0,class:"text-success"},Et={key:1,class:"text-muted"},Gt={class:"btn-group"},Ot=["onClick"],qt=["onClick"],Yt={__name:"pro-ducts",setup(w){const h=s([]),f=s({}),n=s(!1),o=s({}),v=s(null),a=s(null),i=s(!0),y=G("emitter");async function m(e=1){const d=await b.get(`api/karabo-api-cake/admin/products/?page=${e}`);h.value=d.data.products,f.value=d.data.pagination,i.value=!1}N(()=>{m()});function x(e,d){e?(n.value=!1,o.value={}):(n.value=!0,o.value={...d}),v.value.myModal_show()}function M(e){i.value=!0,n.value===!0?b.put(`api/karabo-api-cake/admin/product/${e.id}`,{data:o.value}).then(()=>{m()}):(o.value=e,b.post("api/karabo-api-cake/admin/product",{data:o.value}).then(d=>{d.data.success?(m(),y.emit("push-message",{style:"success",title:"更新成功"})):y.emit("push-message",{style:"danger",title:"更新失敗",content:d.data.message.join("、")})})),v.value.myModal_hide()}function $(e){i.value=!0,b.delete(`/api/karabo-api-cake/admin/product/${e}`).then(()=>{m()})}async function l(){const e=b.delete(`api/karabo-api-cake/admin/product/${o.value.id}`);console.log(e.data),a.value.myModal_hide(),await m()}return(e,d)=>{const F=O("Load-ing");return u(),p(C,null,[g(F,{active:i.value},null,8,["active"]),g(tt),t("div",It,[t("button",{class:"btn btn-primary",type:"button",onClick:d[0]||(d[0]=c=>x(!0))}," 增加一個產品 ")]),t("table",Rt,[Tt,t("tbody",null,[(u(!0),p(C,null,U(h.value,c=>(u(),p("tr",{key:c.id},[t("td",null,k(c.category),1),t("td",null,k(c.title),1),t("td",zt,k(e.$filters.currency(c.origin_price)),1),t("td",St,k(e.$filters.currency(c.price)),1),t("td",null,[c.is_enabled?(u(),p("span",At,"啟用")):(u(),p("span",Et,"未啟用"))]),t("td",null,[t("div",Gt,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:L=>x(!1,c)},"編輯",8,Ot),t("button",{class:"btn btn-outline-danger btn-sm",onClick:L=>$(c.id)},"刪除",8,qt)])])]))),128))])]),g(P,{pages:f.value,onUpdatePage:m},null,8,["pages"]),g(Bt,{ref_key:"modal",ref:v,product:o.value,onUpdateProduct:M},null,8,["product"]),g(H,{item:o.value,ref_key:"delModal",ref:a,onDelItem:l},null,8,["item"])],64)}}};export{Yt as default};

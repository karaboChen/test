import{_ as P}from"./PagiNation-749af4bc.js";import{i as _}from"./backend-c2d93911.js";import{f as s,y as L,l as V,o as b,c as v,a as t,i as d,v as u,z as D,d as I,A as N,s as j,r as B,b as x,F as U,g as S,t as $}from"./index-7e59a937.js";import{M as T,_ as z}from"./DelModal-69f7e0ca.js";import"./component-functions-9f0d7677.js";const A={class:"modal-dialog modal-xl",role:"document"},E={class:"modal-content border-0"},G=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),O={class:"modal-body"},q={class:"row"},H={class:"col-sm-4"},J={class:"mb-3"},K=t("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),Q={class:"mb-3"},R=t("label",{for:"customFile",class:"form-label"},[I("或 上傳圖片 "),t("i",{class:"fas fa-spinner fa-spin"})],-1),W=["src"],X=N('<div class="mt-5"><div class="mb-3 input-group"><input type="url" class="form-control form-control" placeholder="請輸入連結"><button type="button" class="btn btn-outline-danger"> 移除 </button></div><div><button class="btn btn-outline-primary btn-sm d-block w-100"> 新增圖片 </button></div></div>',1),Y={class:"col-sm-8"},Z={class:"mb-3"},tt=t("label",{for:"title",class:"form-label"},"標題",-1),et={class:"row gx-2"},lt={class:"mb-3 col-md-6"},ot=t("label",{for:"category",class:"form-label"},"分類",-1),at={class:"mb-3 col-md-6"},st=t("label",{for:"price",class:"form-label"},"單位",-1),nt={class:"row gx-2"},it={class:"mb-3 col-md-6"},dt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),ct={class:"mb-3 col-md-6"},rt=t("label",{for:"price",class:"form-label"},"售價",-1),ut=t("hr",null,null,-1),pt={class:"mb-3"},mt=t("label",{for:"description",class:"form-label"},"產品描述",-1),_t={class:"mb-3"},bt=t("label",{for:"content",class:"form-label"},"說明內容",-1),vt={class:"mb-3"},ft={class:"form-check"},ht=t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),yt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1),gt={__name:"Product-modal",props:{product:{type:Object,default:()=>({})}},emits:["update-product"],setup(M,{expose:f,emit:h}){const p=M,a=s({}),m=s(null),l=s({}),c=s(null);function y(){h("update-product",l.value)}L(()=>p.product,()=>{l.value=p.product},{deep:!0});const r=()=>{a.value.show()},g=()=>{a.value.hide()};V(()=>{a.value=new T(m.value)}),f({myModal_show:r,myModal_hide:g});function w(){const k=c.value.files[0],o=new FormData;o.append("file-to-upload",k),_.post("/api/karabo-api-cake/admin/upload",o).then(e=>{console.log(e.data),e.data.success&&(l.value.imageUrl=e.data.imageUrl,c.value.value="")})}return(k,o)=>(b(),v("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref_key:"modal",ref:m},[t("div",A,[t("div",E,[G,t("div",O,[t("div",q,[t("div",H,[t("div",J,[K,d(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>l.value.imageUrl=e),class:"form-control",id:"image",placeholder:"請輸入圖片連結"},null,512),[[u,l.value.imageUrl]])]),t("div",Q,[R,t("input",{type:"file",id:"customFile",class:"form-control",onChange:w,ref_key:"fileInput",ref:c},null,544)]),t("img",{class:"img-fluid",alt:"",src:l.value.imageUrl},null,8,W),X]),t("div",Y,[t("div",Z,[tt,d(t("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":o[1]||(o[1]=e=>l.value.title=e)},null,512),[[u,l.value.title]])]),t("div",et,[t("div",lt,[ot,d(t("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入分類","onUpdate:modelValue":o[2]||(o[2]=e=>l.value.category=e)},null,512),[[u,l.value.category]])]),t("div",at,[st,d(t("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":o[3]||(o[3]=e=>l.value.unit=e)},null,512),[[u,l.value.unit]])])]),t("div",nt,[t("div",it,[dt,d(t("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":o[4]||(o[4]=e=>l.value.origin_price=e)},null,512),[[u,l.value.origin_price]])]),t("div",ct,[rt,d(t("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":o[5]||(o[5]=e=>l.value.price=e)},null,512),[[u,l.value.price]])])]),ut,t("div",pt,[mt,d(t("textarea",{"onUpdate:modelValue":o[6]||(o[6]=e=>l.value.description=e),type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述"},null,512),[[u,l.value.description]])]),t("div",_t,[bt,d(t("textarea",{"onUpdate:modelValue":o[7]||(o[7]=e=>l.value.content=e),type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容"},null,512),[[u,l.value.content]])]),t("div",vt,[t("div",ft,[d(t("input",{class:"form-check-input","onUpdate:modelValue":o[8]||(o[8]=e=>l.value.is_enabled=e),type:"checkbox","true-value":1,"false-value":0,id:"is_enabled"},null,512),[[D,l.value.is_enabled]]),ht])])])])]),t("div",{class:"modal-footer"},[yt,t("button",{type:"button",class:"btn btn-primary",onClick:y},"確認")])])])],512))}},kt={class:"text-end mt-3"},xt={class:"table mt-4"},$t=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"200"},"編輯")])],-1),wt={class:"text-right"},Mt={class:"text-right"},Ut={key:0,class:"text-success"},Vt={key:1,class:"text-muted"},Ct={class:"btn-group"},Ft=["onClick"],Pt=["onClick"],Bt={__name:"pro-ducts",setup(M){const f=s([]),h=s({}),p=s(!1),a=s({}),m=s(null),l=s(null),c=s(!0),y=j("emitter");async function r(e=1){const n=await _.get(`api/karabo-api-cake/admin/products/?page=${e}`);f.value=n.data.products,h.value=n.data.pagination,c.value=!1}V(()=>{r()});function g(e,n){e?(p.value=!1,a.value={}):(p.value=!0,a.value={...n}),m.value.myModal_show()}function w(e){c.value=!0,p.value===!0?_.put(`api/karabo-api-cake/admin/product/${e.id}`,{data:a.value}).then(()=>{r()}):(a.value=e,_.post("api/karabo-api-cake/admin/product",{data:a.value}).then(n=>{n.data.success?(r(),y.emit("push-message",{style:"success",title:"更新成功"})):y.emit("push-message",{style:"danger",title:"更新失敗",content:n.data.message.join("、")})})),m.value.myModal_hide()}function k(e){c.value=!0,_.delete(`/api/karabo-api-cake/admin/product/${e}`).then(()=>{r()})}async function o(){const e=_.delete(`api/karabo-api-cake/admin/product/${a.value.id}`);console.log(e.data),l.value.myModal_hide(),await r()}return(e,n)=>{const C=B("Load-ing");return b(),v(U,null,[x(C,{active:c.value},null,8,["active"]),t("div",kt,[t("button",{class:"btn btn-primary",type:"button",onClick:n[0]||(n[0]=i=>g(!0))}," 增加一個產品 ")]),t("table",xt,[$t,t("tbody",null,[(b(!0),v(U,null,S(f.value,i=>(b(),v("tr",{key:i.id},[t("td",null,$(i.category),1),t("td",null,$(i.title),1),t("td",wt,$(e.$filters.currency(i.origin_price)),1),t("td",Mt,$(e.$filters.currency(i.price)),1),t("td",null,[i.is_enabled?(b(),v("span",Ut,"啟用")):(b(),v("span",Vt,"未啟用"))]),t("td",null,[t("div",Ct,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:F=>g(!1,i)},"編輯",8,Ft),t("button",{class:"btn btn-outline-danger btn-sm",onClick:F=>k(i.id)},"刪除",8,Pt)])])]))),128))])]),x(P,{pages:h.value,onUpdatePage:r},null,8,["pages"]),x(gt,{ref_key:"modal",ref:m,product:a.value,onUpdateProduct:w},null,8,["product"]),x(z,{item:a.value,ref_key:"delModal",ref:l,onDelItem:o},null,8,["item"])],64)}}};export{Bt as default};
